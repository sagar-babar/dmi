server {
	listen  80;
	listen  443 ssl;
	client_max_body_size 20M;

	# VPC internal DNS
	resolver  10.9.0.2;

	server_name  dspdev-useast.cloudmi.datami.com   api.internal.datami.com  localhost  127.0.0.1;

	# Include SSL configuration
	include  /usr/local/nginx/conf/dmi/common/ssl.conf;

	#location  / {
	#	return  404;
	#}

	location  = /robots.txt {
		echo "User-agent: *\nDisallow: /";
	}

	location  /healthcheck {
		access_log  off;
		echo  "ok";
	}

	# Protect against PHP brute force attack
	location  ~ \.php$ {
		limit_req_status  444;

		location  ~* wp\-login\.php {
			limit_req   zone=one  burst=1 nodelay;
			access_log  on;
			deny all;
		}
	}

	#error_page  404              /404.html;

	# redirect server error pages to the static page /50x.html
	#error_page  500 502 503 504  /50x.html;
	#location = /50x.html {
	#	root  html;
	#}

	#access_log  logs/host.access.log  main;

	# JS-SDK Support: CORS support for all requests!
	more_set_headers 'Access-Control-Allow-Methods: POST,GET,OPTIONS';
	more_set_headers 'Access-Control-Allow-Headers: $http_access_control_request_headers';
	more_set_headers 'Access-Control-Allow-Origin: *';

	include  /usr/local/nginx/conf/dmi/services/bid-agent.conf;
	include  /usr/local/nginx/conf/dmi/services/analytics.conf;
	include  /usr/local/nginx/conf/dmi/services/portal-fe.conf;
	include  /usr/local/nginx/conf/dmi/services/portal-be.conf;
	include  /usr/local/nginx/conf/dmi/services/ad-server.conf;
}
